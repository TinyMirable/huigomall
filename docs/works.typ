#import "template.typ": *

#show : template

#align(center)[#text(size:24pt,weight : "bold")[网络应用架构]]
#outline(indent : 2em,depth :2)
= 任务清单
- [ ] Design
    - [x] DOCS
        - [x] 软件需求分析规格说明书
        - [ ] 软件设计说明书（概要设计+详细设计）
        - [ ] 用户手册（软件安装、使用、配置与维护说明书）
        - [ ] 总结报告
        - [ ] 代码
        - [ ] 汇报ppt
    - [ ] DataBase
    - [ ] API
    - [ ] UI
- [ ] Technology Stack
    - Backend: Java 21, Spring Boot, Spring Security, Spring Data JPA, Spring Data Redis, Spring Data Elasticsearch, Spring Data MongoDB, Spring Data Solr, Spring Data Gemfire, Spring Data Neo4j
    - Frontend: Vue 3, Vite, Vue Router, Vuex, Vue-i18n, Vue-i18n
    - Database: PostgreSQL, Redis, Elasticsearch, MongoDB

= 功能实现TODO清单（基于SRS文档）
== 第一阶段：基础设施和用户认证（P1优先级）
- [ ] 实现用户注册功能
    - [ ] 手机号注册（验证码发送和验证）
    - [ ] 邮箱注册（验证码发送和验证）
    - [ ] 密码强度验证
    - [ ] 新用户自动发放10张8折优惠券
- [ ] 实现用户登录功能
    - [ ] 手机号/邮箱+密码登录
    - [ ] 手机号+短信验证码免密码登录
    - [ ] JWT认证和会话管理
    - [ ] 登录失败限制（5次失败锁定30分钟）
- [ ] 实现忘记密码功能
    - [ ] 验证码重置密码
- [ ] 实现用户注销功能
- [ ] 实现系统管理员账户管理（手动创建，不支持注册）
- [ ] 实现角色权限控制（顾客/系统管理员）

== 第二阶段：商品管理（P1优先级）
- [ ] 实现商品分类管理
    - [ ] 多级分类CRUD
- [ ] 实现商品管理（系统管理员）
    - [ ] 商品添加（名称、价格、库存、描述、图片URL、分类）
    - [ ] 商品编辑
    - [ ] 商品删除（记录审计日志）
    - [ ] 商品上架/下架状态管理
    - [ ] 库存预警（库存≤50时提醒）
- [ ] 实现商品浏览（用户端）
    - [ ] 商品列表展示（分页，只显示上架商品）
    - [ ] 商品详情页展示
    - [ ] 按分类筛选商品
    - [ ] 商品排序功能（价格、销量、上架时间）- P2优先级，基础功能后实现

== 第三阶段：购物车和收货地址（P1优先级）
- [ ] 实现收货地址管理
    - [ ] 添加收货地址
    - [ ] 编辑收货地址
    - [ ] 删除收货地址
    - [ ] 设置默认地址
- [ ] 实现购物车功能
    - [ ] 添加商品到购物车
    - [ ] 修改购物车商品数量
    - [ ] 删除购物车商品
    - [ ] 购物车持久化存储
    - [ ] 购物车总金额计算

== 第四阶段：订单管理（P1优先级）
- [ ] 实现订单创建
    - [ ] 从购物车创建订单
    - [ ] 从商品详情页直接购买
    - [ ] 库存检查和原子操作扣减
    - [ ] 订单快照（商品快照、地址快照）
    - [ ] 优惠券选择和使用（原子操作）
- [ ] 实现订单查看
    - [ ] 用户订单列表
    - [ ] 订单详情查看
- [ ] 实现订单状态管理
    - [ ] 订单取消（待付款、待发货状态）
    - [ ] 订单状态自动流转（已付款→待发货→已发货→运输中→已送到）
    - [ ] 订单30分钟未支付自动取消（定时任务）
- [ ] 实现确认收货功能
    - [ ] 用户主动确认收货
    - [ ] 24小时自动确认收货（定时任务）

== 第五阶段：支付集成（P1优先级）
- [ ] 集成支付平台（微信支付或支付宝）
    - [ ] 支付平台沙箱环境配置
    - [ ] 支付接口调用
    - [ ] 支付回调处理（幂等性处理）
    - [ ] 支付结果验证
- [ ] 实现支付流程
    - [ ] 支付页面展示
    - [ ] 支付成功后订单状态更新
    - [ ] 支付失败处理

== 第六阶段：优惠券系统（P1优先级）
- [ ] 实现优惠券管理
    - [ ] 优惠券查看（用户端）
    - [ ] 优惠券使用（订单创建时）
    - [ ] 优惠券使用原子操作（锁机制）

== 第七阶段：退货退款（P2优先级）
- [ ] 实现退款申请
    - [ ] 用户申请退款（选择退款原因）
    - [ ] 退款申请状态管理（待审核、已同意、已拒绝）
- [ ] 实现退款审核（系统管理员）
    - [ ] 退款申请列表查看
    - [ ] 退款审核（同意/拒绝）
    - [ ] 自动退款（2分钟未确认自动同意，可配置）
- [ ] 实现退款处理
    - [ ] 退款成功后库存恢复
    - [ ] 退款通知（短信）

== 第八阶段：销售管理（P1优先级）
- [ ] 实现订单管理（系统管理员）
    - [ ] 所有订单列表查看
    - [ ] 订单详情查看
    - [ ] 订单状态更新
- [ ] 实现销售报表
    - [ ] 总销售额统计
    - [ ] 总订单数统计
    - [ ] 总商品销量统计
    - [ ] 过去一个月趋势图表（折线图）
    - [ ] 按日期范围查询

== 第九阶段：通知系统（P1优先级）
- [ ] 实现邮件通知
    - [ ] 订单支付成功邮件通知
    - [ ] 邮件服务集成（SMTP）
- [ ] 实现短信通知
    - [ ] 订单已送到短信通知
    - [ ] 退款成功短信通知
    - [ ] 短信服务集成
    - [ ] 验证码发送（注册、登录、忘记密码）

== 第十阶段：审计日志（P1优先级）
- [ ] 实现操作审计日志
    - [ ] 记录商品价格/库存修改操作
    - [ ] 记录订单状态更新操作
    - [ ] 记录删除操作（商品、地址）
    - [ ] 审计日志查看（系统管理员）

== 第十一阶段：缓存优化（P1优先级）
- [ ] 实现Redis缓存
    - [ ] 商品列表缓存
    - [ ] 商品详情缓存
    - [ ] 缓存更新策略

== 第十二阶段：可选功能（P2/P3优先级）
- [ ] 实现图片验证码（P2，可选）
- [ ] 实现商品搜索功能（P2，高优先级备选）
- [ ] 实现商品收藏功能（P3）
- [ ] 实现推荐区/热门商品（P3）

= Problems anlysis
== 软件定义
=== 问题定义
就是要解决线上购物问题
=== 可行性分析
不用分析，直接可行
=== 需求分析
当前的需求是*在完成基本功能的基础之上，尽可能多的实现其他功能*
==== 基础功能
分为两个角色
- 顾客：
    - 注册，登录，注销
    - 浏览商品列表
    - 浏览商品详细，加入购物车，付款购买商品，发送电子邮件确认收货

    - 查看订单的状态和历史
- 销售管理：
    - CRUD商品
    - 订单管理
    - 销售统计报表
==== 个人理解的功能
- 顾客：
    - 通过手机号，邮箱注册，要发送验证码，并使用JWT鉴权，通过cookie存储用户数据
    - 需要设计获取首页商品的API，并使用Redis缓存，这是经常会用到的
    - 商品详细请求，需要获取商品详细页的API
    - 购物车，一个人一个购物车，购物车内的商品CRUD，还需要可以选择批量下单
    - 付款，使用微信支付，需要看一下怎么实现支付和退款，退款需要考虑退款信息
    - 在支付成功后，需要发送电子邮件确认收货
    - 查看订单的状态和历史
    - 额外的，可以设计一个优惠券，为了方便测试，每个商品都有优化券将商品价格变为0.1元
- 销售管理：
    - 登录，无法直接注册，使用定义好的账号
    - 商品管理，CRUD商品，商品可以有多个图片，商品可以有多个规格，商品可以有多个属性
    - 订单管理，？
    - 销售统计报表，？
=== 成本分析